(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,a){e.exports=a(22)},21:function(e,t,a){},22:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(11),c=a.n(r),i=a(1),o=a(2),l=a(4),u=a(3),m=a(5),p=a(9),h=a(6),d=a.n(h),f=a(7),b=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("nav",{className:"navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow"},s.a.createElement("a",{href:"#",className:"navbar-brand col-sm-3 col-md-2 mr-0"},this.props.user),s.a.createElement("ul",{className:"navbar-nav px-3"},s.a.createElement("li",{className:"nav-item text-nowrap"},s.a.createElement("a",{className:"nav-link",href:"#",onClick:this.props.logout},"Sign out")))))}}]),t}(n.Component),g=0,v=2,k=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("nav",{className:"col-md-2 d-none d-md-block bg-light sidebar"},s.a.createElement("div",{className:"sidebar-sticky"},s.a.createElement("ul",{className:"nav flex-column"},s.a.createElement("li",{className:"nav-item"},s.a.createElement("a",{href:"#",className:this.props.active===g?"nav-link active":"nav-link",onClick:this.props.displayDashboard},s.a.createElement("span",{"data-feather":"home"}),"Dashboard")),s.a.createElement("li",{className:"nav-item"},s.a.createElement("a",{href:"#",className:this.props.active===v?"nav-link active":"nav-link",onClick:this.props.displayNotifications},s.a.createElement("span",{"data-feather":"home"}),"Notifications ",s.a.createElement("span",{className:"badge badge-light"},this.props.notificationCounter))))))}}]),t}(n.Component),E=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"card"},s.a.createElement("img",{className:"card-img-top",alt:"organization avatar",src:this.props.avatarURL}),s.a.createElement("div",{className:"card-body d-flex flex-column"},s.a.createElement("h5",{className:"card-title text-center"},this.props.name),s.a.createElement("p",{className:"card-text"},this.props.description),s.a.createElement("a",{href:"#",name:this.props.name,onClick:this.props.displayDetails,className:"btn btn-light mt-auto text-center"},"DETAILS"))))}}]),t}(n.Component),y=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"renderObj",value:function(){var e=this;return Object.keys(this.props.notification).map(function(t){return"link"===t?s.a.createElement("a",{href:e.props.notification.link,target:"_blank",className:"btn btn-primary"},"GitHub"):"unseen"===t?void 0:s.a.createElement("p",{className:"card-text"},t,": ",e.props.notification[t])})}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"card mx-auto my-2 text-center",style:{width:"25rem"}},s.a.createElement("div",{className:"card-header ".concat(this.props.notification.unseen?"unseen":"")}),s.a.createElement("div",{className:"card-body"},s.a.createElement("h5",{className:"card-title"},"Notification"),this.renderObj())))}}]),t}(n.Component),N=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.props.resetCounter()}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,this.props.notifications.map(function(e){return s.a.createElement(y,{notification:e})}))}}]),t}(n.Component),x=a(8),O=a(12),j=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={settings:{repository:!1,push:!1,issues:!1,project:!1,release:!1,deployment:!1,fork:!1,repository_vulnerability_alert:!1}},a.handleCheckboxChange=function(){var e=Object(f.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("checkbox"!==t.target.type){e.next=14;break}return e.prev=1,e.next=4,a.setState({settings:Object(O.a)({},a.state.settings,Object(x.a)({},t.target.name,!a.state.settings[t.target.name]))});case 4:return n=JSON.stringify({user:a.props.user,org:a.props.org,settings:a.state.settings}),e.next=7,fetch("https://8i58zxdosl.execute-api.eu-north-1.amazonaws.com/prod/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:n});case 7:e.sent,window.sessionStorage.setItem(a.props.org,JSON.stringify(a.state.settings)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,11]])}));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.sessionStorage.getItem(this.props.org)){e.next=2;break}return e.abrupt("return",this.setState({settings:JSON.parse(window.sessionStorage.getItem(this.props.org))}));case 2:return e.prev=2,e.next=5,fetch("https://8i58zxdosl.execute-api.eu-north-1.amazonaws.com/prod/settings/".concat(this.props.user,"/").concat(this.props.org));case 5:if(204!==(t=e.sent).status){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.json();case 10:t=e.sent,this.setState({settings:t}),window.sessionStorage.setItem(this.props.org,JSON.stringify(t)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0);case 18:case"end":return e.stop()}},e,this,[[2,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"row justify-content-center"},s.a.createElement("h3",null,"Notification settings")),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("div",{className:"card",style:{margin:"50px 0"}},s.a.createElement("ul",{className:"list-group list-group-flush"},s.a.createElement("li",{className:"list-group-item"},"Repositories",s.a.createElement("label",{className:"switch "},s.a.createElement("input",{type:"checkbox",checked:this.state.settings.repository,onChange:this.handleCheckboxChange,name:"repository",className:"success"}),s.a.createElement("span",{className:"slider round"}))),s.a.createElement("li",{className:"list-group-item"},"Push",s.a.createElement("label",{className:"switch "},s.a.createElement("input",{type:"checkbox",checked:this.state.settings.push,onChange:this.handleCheckboxChange,name:"push",className:"success"}),s.a.createElement("span",{className:"slider round"}))),s.a.createElement("li",{className:"list-group-item"},"Issues",s.a.createElement("label",{className:"switch "},s.a.createElement("input",{type:"checkbox",checked:this.state.settings.issues,onChange:this.handleCheckboxChange,name:"issues",className:"success"}),s.a.createElement("span",{className:"slider round"}))),s.a.createElement("li",{className:"list-group-item"},"Projects",s.a.createElement("label",{className:"switch "},s.a.createElement("input",{type:"checkbox",checked:this.state.settings.project,onChange:this.handleCheckboxChange,name:"project",className:"success"}),s.a.createElement("span",{className:"slider round"})))))),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("div",{className:"card",style:{margin:"50px 0"}},s.a.createElement("ul",{className:"list-group list-group-flush"},s.a.createElement("li",{className:"list-group-item"},"Releases",s.a.createElement("label",{className:"switch "},s.a.createElement("input",{type:"checkbox",checked:this.state.settings.release,onChange:this.handleCheckboxChange,name:"release",className:"success"}),s.a.createElement("span",{className:"slider round"}))),s.a.createElement("li",{className:"list-group-item"},"Deployments",s.a.createElement("label",{className:"switch "},s.a.createElement("input",{type:"checkbox",checked:this.state.settings.deployment,onChange:this.handleCheckboxChange,name:"deployment",className:"success"}),s.a.createElement("span",{className:"slider round"}))),s.a.createElement("li",{className:"list-group-item"},"Forks",s.a.createElement("label",{className:"switch "},s.a.createElement("input",{type:"checkbox",checked:this.state.settings.fork,onChange:this.handleCheckboxChange,name:"fork",className:"success"}),s.a.createElement("span",{className:"slider round"}))),s.a.createElement("li",{className:"list-group-item"},"Security Alerts",s.a.createElement("label",{className:"switch "},s.a.createElement("input",{type:"checkbox",checked:this.state.settings.repository_vulnerability_alert,onChange:this.handleCheckboxChange,name:"repository_vulnerability_alert",className:"success"}),s.a.createElement("span",{className:"slider round"})))))))))}}]),t}(n.Component),w=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"card text-center col-sm-6"},s.a.createElement("div",{className:"card-header"}),s.a.createElement("div",{className:"card-body"},s.a.createElement("h5",{className:"card-title"},this.props.name),s.a.createElement("p",{className:"card-text"},this.props.description),s.a.createElement("a",{href:this.props.URL,target:"_blank",className:"btn btn-primary"},this.props.name," on GitHub")),s.a.createElement("div",{className:"card-footer text-muted"})))}}]),t}(n.Component),C=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",{className:"display-2 text-center"},this.props.name),this.props.isAdmin&&s.a.createElement(j,{org:this.props.name,user:this.props.user}),s.a.createElement("h1",{className:"display-4 text-center"},"Repos"),s.a.createElement("div",{className:"row"},this.props.repos.map(function(e){return s.a.createElement(w,Object.assign({key:e.name},e))})))}}]),t}(n.Component),S=(a(21),"BGqqZm74jsX141bCEXum-EePHgPFtTCPdeptiUR7KLQDKr_VfGc6fAu9wTZ9lvD8PyMcsaMqdEFiNvftmbmtZ7o"),z={DASHBOARD:0,DETAILS:1,NOTIFICATIONS:2},D=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={user:{},activePage:z.DASHBOARD,notifications:[],notificationCounter:0},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.login();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=Object(f.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.state.socket.close();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removeNotifications",value:function(){var e=Object(f.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://8i58zxdosl.execute-api.eu-north-1.amazonaws.com/prod/notifications/"+this.state.user.nick,{method:"DELETE",credentials:"include"});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}()},{key:"setupSocket",value:function(){var e=this;this.setState({socket:new WebSocket("wss://3owhikvdr6.execute-api.eu-north-1.amazonaws.com/prod?user="+this.state.user.nick)}),this.state.socket.addEventListener("open",function(e){console.log("Socket open...")}),this.state.socket.addEventListener("message",function(t){var a=JSON.parse(t.data);e.setState({notificationCounter:e.state.notificationCounter+1,notifications:[].concat(Object(p.a)(e.state.notifications),[a]).reverse()})})}},{key:"setupWebhooks",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.state.user.organizations.length)){e.next=15;break}if(!this.state.user.organizations[t].isAdmin||this.state.user.organizations[t].hasHook){e.next=12;break}return e.prev=3,e.next=6,fetch("https://8i58zxdosl.execute-api.eu-north-1.amazonaws.com/prod/webhooks",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({organization:this.state.user.organizations[t].name})});case 6:e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log(e.t0);case 12:t++,e.next=1;break;case 15:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({user:{},activePage:z.DASHBOARD,isAuthorized:!1}),window.sessionStorage.clear(),this.state.socket.close(),e.prev=3,e.next=6,fetch("https://8i58zxdosl.execute-api.eu-north-1.amazonaws.com/prod/logout",{method:"POST",credentials:"include"});case 6:t=e.sent,console.log(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0);case 13:case"end":return e.stop()}},e,this,[[3,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"resetCounter",value:function(){for(var e=Object(p.a)(this.state.notifications),t=0;t<e.length;t++)e[t].unseen=!1;this.setState({notifications:e,notificationCounter:0}),this.removeNotifications()}},{key:"displayDashboard",value:function(){this.setState({activePage:z.DASHBOARD,chosenOrg:{}})}},{key:"displayNotifications",value:function(){this.setState({activePage:z.NOTIFICATIONS})}},{key:"displayDetails",value:function(e){var t=e.target.name;this.setState({activePage:z.DETAILS,chosenOrg:this.state.user.organizations.filter(function(e){return e.name===t})[0]})}},{key:"login",value:function(){var e=Object(f.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),e.prev=1,e.next=4,fetch("https://8i58zxdosl.execute-api.eu-north-1.amazonaws.com/prod/getUser",{credentials:"include"});case 4:if(401!==(a=e.sent).status){e.next=8;break}return this.setState({isLoading:!1}),e.abrupt("return");case 8:if(200!==a.status){e.next=18;break}return e.next=11,a.json();case 11:return a=e.sent,this.setState({isLoading:!1,isAuthorized:!0,user:{nick:a.nick,avatarURL:a.avatarURL,organizations:a.organizations},notificationCounter:a.notifications.length,notifications:a.notifications}),e.next=15,this.setupSocket();case 15:return e.next=17,this.setupWebhooks();case 17:"serviceWorker"in navigator&&A(a.nick);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),console.log(e.t0);case 23:case"end":return e.stop()}},e,this,[[1,20]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this;return this.state.isLoading?s.a.createElement("div",{className:"text-center login-div"},s.a.createElement("span",null,"Loading...")):this.state.isAuthorized?(this.state.activePage===z.DASHBOARD&&(e=s.a.createElement("div",{className:"card-columns"},this.state.user.organizations.map(function(e){return s.a.createElement(E,Object.assign({key:e.name},e,{displayDetails:t.displayDetails.bind(t)}))}))),this.state.activePage===z.DETAILS&&(e=s.a.createElement(C,Object.assign({},this.state.chosenOrg,{user:this.state.user.nick,token:this.state.user.token}))),this.state.activePage===z.NOTIFICATIONS&&(e=s.a.createElement(N,{notifications:this.state.notifications,resetCounter:this.resetCounter.bind(this)})),s.a.createElement(s.a.Fragment,null,s.a.createElement(b,{user:this.state.user.nick,logout:this.logout.bind(this)}),s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"row"},s.a.createElement(k,{active:this.state.activePage,displayDashboard:this.displayDashboard.bind(this),displayNotifications:this.displayNotifications.bind(this),notificationCounter:this.state.notificationCounter}),s.a.createElement("main",{role:"main",className:"col-md-9 ml-sm-auto col-lg-10 px-4"},s.a.createElement("div",{className:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},s.a.createElement("h1",{className:"h2"},"Dashboard"),s.a.createElement("img",{src:this.state.user.avatarURL,className:"user-avatar rounded-circle float-right",alt:"user avatarxx"})),e))))):s.a.createElement("div",{className:"text-center login-div"},s.a.createElement("a",{href:"https://8i58zxdosl.execute-api.eu-north-1.amazonaws.com/prod/auth",className:"btn btn-github btn-lg active",role:"button","aria-pressed":"true"},"Login at Github"))}}]),t}(n.Component);function A(e){return I.apply(this,arguments)}function I(){return(I=Object(f.a)(d.a.mark(function e(t){var a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.serviceWorker.register("serviceWorker.js",{scope:"/"});case 2:return a=e.sent,e.next=5,navigator.serviceWorker.ready;case 5:return e.next=7,a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:L(S)});case 7:return n=e.sent,e.next=10,fetch("https://8i58zxdosl.execute-api.eu-north-1.amazonaws.com/prod/register",{method:"POST",body:JSON.stringify({subscription:n,user:t}),headers:{"content-type":"application/json"}});case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(t),n=new Uint8Array(a.length),s=0;s<a.length;++s)n[s]=a.charCodeAt(s);return n}var P=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(D,null))}}]),t}(n.Component);c.a.render(s.a.createElement(P,null),document.getElementById("root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.93a77c1c.chunk.js.map